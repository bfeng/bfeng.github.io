---
layout: post
title: "Minix IPC Server Design"
date: 2012-10-19 03:22:25 UTC
updated: 2012-10-19 03:22:25 UTC
comments: false
categories: 
---

<br /><br /><h2 style="-webkit-font-smoothing: antialiased; background-color: white; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-width: 0px 0px 1px; cursor: text; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 24px; margin: 0px 0px 10px; padding: 0px; position: relative;">Overview</h2><div style="background-color: white; border: 0px; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14.44444465637207px; line-height: 24.44444465637207px; margin-bottom: 15px; padding: 0px;"><img alt="Overview of MIPC" src="https://a248.e.akamai.net/camo.github.com/1e85845d98890fd706817667f49d7c4135695e62/687474703a2f2f646c2e64726f70626f782e636f6d2f752f35393931323231392f6f766572766965772e706e67" style="border: 0px; margin: 0px; max-width: 100%; padding: 0px;" /></div><h2 style="-webkit-font-smoothing: antialiased; background-color: white; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-width: 0px 0px 1px; cursor: text; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 24px; margin: 20px 0px 10px; padding: 0px; position: relative;">How to install</h2><ol style="background-color: white; border: 0px; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14.44444465637207px; line-height: 24.44444465637207px; margin: 15px 0px; padding: 0px 0px 0px 30px;"><li style="border: 0px; margin: 0px; padding: 0px;"><code style="background-color: #f8f8f8; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; border: 1px solid rgb(234, 234, 234); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; margin: 0px 2px; padding: 0px 5px; white-space: nowrap;">cd /usr/src/tools</code></li><li style="border: 0px; margin: 0px; padding: 0px;"><code style="background-color: #f8f8f8; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; border: 1px solid rgb(234, 234, 234); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; margin: 0px 2px; padding: 0px 5px; white-space: nowrap;">make install</code></li><li style="border: 0px; margin: 0px; padding: 0px;">boot to the customized image, you will see&nbsp;<code style="background-color: #f8f8f8; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; border: 1px solid rgb(234, 234, 234); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; margin: 0px 2px; padding: 0px 5px; white-space: nowrap;">kernel ds ... mipc init</code></li><li style="border: 0px; margin: 0px; padding: 0px;">check mipc server is running:&nbsp;<code style="background-color: #f8f8f8; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; border: 1px solid rgb(234, 234, 234); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; margin: 0px 2px; padding: 0px 5px; white-space: nowrap;">pe -e | grep mipc</code></li></ol><h2 style="-webkit-font-smoothing: antialiased; background-color: white; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-width: 0px 0px 1px; cursor: text; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 24px; margin: 20px 0px 10px; padding: 0px; position: relative;">Source code folder</h2><div style="background-color: white; border: 0px; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14.44444465637207px; line-height: 24.44444465637207px; margin-bottom: 15px; padding: 0px;"><code style="background-color: #f8f8f8; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; border: 1px solid rgb(234, 234, 234); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; margin: 0px 2px; padding: 0px 5px; white-space: nowrap;">/usr/src/servers/mipc</code></div><h2 style="-webkit-font-smoothing: antialiased; background-color: white; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-width: 0px 0px 1px; cursor: text; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 24px; margin: 20px 0px 10px; padding: 0px; position: relative;">function</h2><div style="background-color: white; border: 0px; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14.44444465637207px; line-height: 24.44444465637207px; margin-bottom: 15px; padding: 0px;"><code style="background-color: #f8f8f8; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; border: 1px solid rgb(234, 234, 234); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; margin: 0px 2px; padding: 0px 5px; white-space: nowrap;">PUBLIC int main(int argc, char *argv[]);</code></div><ul style="background-color: white; border: 0px; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14.44444465637207px; line-height: 24.44444465637207px; margin: 15px 0px; padding: 0px 0px 0px 30px;"><li style="border: 0px; margin: 0px; padding: 0px;">the function will maintain an infinite while loop to handle all system calls.</li><li style="border: 0px; margin: 0px; padding: 0px;">it will match which function is requested and pass the call to a manager.</li></ul><div style="background-color: white; border: 0px; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14.44444465637207px; line-height: 24.44444465637207px; margin-bottom: 15px; margin-top: 15px; padding: 0px;"><code style="background-color: #f8f8f8; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; border: 1px solid rgb(234, 234, 234); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; margin: 0px 2px; padding: 0px 5px; white-space: nowrap;">PUBLIC int check(int uid, int group_id, int action);</code></div><ul style="background-color: white; border: 0px; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14.44444465637207px; line-height: 24.44444465637207px; margin: 15px 0px; padding: 0px 0px 0px 30px;"><li style="border: 0px; margin: 0px; padding: 0px;">There is a configuration file to define the privelege of each group created by users. The structure of this file is like this:</li></ul><pre style="background-color: #f8f8f8; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; border: 1px solid rgb(204, 204, 204); color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 13px; line-height: 19px; margin-bottom: 15px; margin-top: 15px; overflow: auto; padding: 6px 10px;">+-----+----------------+<br />|user1|(user2 user3)   |<br />|user2|(user1)         |<br />|user3|(user1)         |<br />+-----+----------------+<br /></pre><ul style="background-color: white; border: 0px; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14.44444465637207px; line-height: 24.44444465637207px; margin: 15px 0px; padding: 0px 0px 0px 30px;"><li style="border: 0px; margin: 0px; padding: 0px;"><div style="border: 0px; margin-bottom: 15px; padding: 0px;">This means the group created by user1 is allowed to be subscribed or published by user1, user2 and user3. The group created by user2 or user3 is allowed both themselves and user1 to become the subscriber or publisher of this group.</div></li><li style="border: 0px; margin: 0px; padding: 0px;"><div style="border: 0px; margin-bottom: 15px; padding: 0px;">The parameter uid is the user's id.</div></li><li style="border: 0px; margin: 0px; padding: 0px;"><div style="border: 0px; margin-bottom: 15px; padding: 0px;">group_id is the id of the group defined internally in the server.</div></li><li style="border: 0px; margin: 0px; padding: 0px;"><div style="border: 0px; margin-bottom: 15px; padding: 0px;">action is the action needs to be checked: declare_subsciber or declare_publisher.</div></li><li style="border: 0px; margin: 0px; padding: 0px;"><div style="border: 0px; margin-bottom: 15px; padding: 0px;">The return value could be 0 (false), 1 (true) and -1 (error).</div></li></ul><h2 style="-webkit-font-smoothing: antialiased; background-color: white; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-width: 0px 0px 1px; cursor: text; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 24px; margin: 20px 0px 10px; padding: 0px; position: relative;">library</h2><ul style="background-color: white; border: 0px; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14.44444465637207px; line-height: 24.44444465637207px; margin: 15px 0px; padding: 0px 0px 0px 30px;"><li style="border: 0px; margin: 0px; padding: 0px;">It should provide a header file by including which a user process should be allowed to use the&nbsp;<a href="https://github.com/bfeng/mipc/wiki/System-calls" style="border: 0px; color: #4183c4; margin: 0px; padding: 0px; text-decoration: none;">system calls</a>.</li></ul><br />
